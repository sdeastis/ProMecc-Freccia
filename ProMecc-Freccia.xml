<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="http://jsbsim.sourceforge.net/JSBSim.xsl"?>

<fdm_config name="ProMecc-Freccia" version="2.0" release="ALPHA"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:noNamespaceSchemaLocation="http://jsbsim.sourceforge.net/JSBSim.xsd">

 <fileheader>
  <author> Aeromatic v 3.3.15 </author>
  <filecreationdate> 24 Sep 2021 </filecreationdate>
  <version>$Revision: 0.1.0 $</version>
  <description> 
	Models a ProMecc-Freccia.
	* Start Point.
  </description>
  
  <author> Salvatore De Astis </author>
  <filecreationdate> 28 Sep 2021 </filecreationdate>
  <version>$Revision: 0.2.0 $</version>
  <description> 
	Models a ProMecc-Freccia.
	* Datcom+: stability deriatives integrated.
	* Tuning of : Metrics, Mass Balance, Point Masses, 
	  Ground Reaction, Flight Comtrols 
  </description>

  <author> Salvatore De Astis </author>
  <filecreationdate> 2 Oct 2021 </filecreationdate>
  <version>$Revision: 0.3.0 $</version>
  <description> 
	Models a ProMecc-Freccia.
	* Datcom+: Pro integration.
	* Fixed Engine and Propeller positions
  </description>
  
  <author> Salvatore De Astis </author>
  <filecreationdate> 5 Nov 2022 </filecreationdate>
  <version>$Revision: 0.4.0 $</version>
  <description> 
	Models a ProMecc-Freccia.
	* Mass and Balance review 
  </description>
 </fileheader>

<!--
  File:     ProMecc-Freccia.xml
  Inputs:
    name:          ProMecc-Freccia
    type:          Single engine WWII Fighter, Military Trainer, Aerobatic, Air Racer
    stall speed:   41.04kts
    max weight:    1041.86 lb
    length:        23.78 ft
    wing: 
     span:         28.80 ft
     area:         109.04 sq-ft
     mean chord:   5.13 ft
     aspect ratio: 7.54:1
     taper ratio:  1.57:1
     incidence:    0.00 degrees
     dihedral:     5.00 degrees
     sweep:        1.00 degrees

    no. engines:   1
    engine type:   Piston Engine
    engine layout: forward fuselage

    gear type:     tricycle
    steering type: steering
    retractable?:  no

  Outputs:
    wing loading:       9.56 lb/sq-ft
     - thickness ratio: 8.02%
    payload:            264.28 lbs
    CL-alpha:           5.33 per radian
    CL-0:               0.37
    CL-max:             1.68
    CD-0:               0.02
    K:                  0.06
    Mcrit:              0.75

    min. turn radius    82.31 ft
    max. turn rate:     0.93 deg/s
-->

<!-- **********************************************************************
        METRICS and CONSTANTS
     *******************************************************************-->
	<metrics>
		<wingarea  unit="FT2">91</wingarea>
		<wingspan  unit="FT" >28.8</wingspan>
		<chord     unit="FT" >3.9</chord>
		<htailarea unit="FT2">23</htailarea>
		<htailarm  unit="FT" >14.76</htailarm>
		<vtailarea unit="FT2">14.1</vtailarea>
		<vtailarm  unit="FT" >14.76</vtailarm>
		<location name="AERORP" unit="FT">
		      <x>7.15</x>	<!--x>1.24</x-->
		      <z>-0.68</z>
		</location>

 		<!-- These values are not needed in JSBSim but are used in FlightGear. -->
		<location name="EYEPOINT" unit="FT">
			<x>7.94</x>	<!--x>2.03</x-->
			<z>3</z>
		</location>

		<property value="57.2958279  "> RADIANS-TO-DEGREES </property>
		<property value="0.0174532778"> DEGREES-TO-RADIANS </property>
		<property value="0.5924838   "> FPS-TO-KNOTS       </property>
		<property value="60.0"> FPS-TO-FPM </property>

	</metrics>

<!-- **********************************************************************
        MASS_BALANCE
     *******************************************************************-->
	<mass_balance>
		<ixx unit="SLUG*FT2">276</ixx>
		<iyy unit="SLUG*FT2">312</iyy>
		<izz unit="SLUG*FT2">541</izz>
		<ixz unit="SLUG*FT2">4</ixz>
		<emptywt unit="LBS">628</emptywt>
		<location name="CG" unit="FT">
		      <x>7.15</x>	<!--x>1.24</x-->
		      <z>-0.68</z>
		</location>
		<pointmass name="PILOT">
			<weight unit="LBS">170.42</weight>
			<location name="POINTMASS" unit="FT">
			 <x>7.94</x>	<!--x>2.03</x-->
			 <y>-0.95</y>
			 <z>-1.21 </z>
			</location>
		</pointmass>
		<pointmass name="CO-PILOT">
			<weight unit="LBS"> 0.0 </weight>
			<location name="POINTMASS" unit="FT">
			 <x>7.94</x>	<!--x>2.03</x-->
			 <y>0.95</y>
			 <z>-1.21 </z>
			</location>
		</pointmass>
		<pointmass name="LUGGAGE">
			<weight unit="LBS"> 0.0 </weight>
			<location name="POINTMASS" unit="FT">
			 <x>9.91</x>		<!--x>4</x-->
			 <z>-1.21</z>
			</location>
		</pointmass>
	</mass_balance>

<!-- **********************************************************************
        UNDERCARRIAGE
     *******************************************************************-->
	<ground_reactions>
		<!-- DATCOM does not calculate ground reactions parameters. -->
		<contact type="BOGEY" name="NOSE">
			<location unit="FT">
			 <x> 2.66</x>	<!--x>-3.25</x-->
			 <z>-3.29</z>
			</location>
			<static_friction>  0.80 </static_friction>
			<dynamic_friction> 0.50 </dynamic_friction>
			<rolling_friction> 0.02 </rolling_friction>
			<spring_coeff unit="LBS/FT">     3000 </spring_coeff>
			<damping_coeff unit="LBS/FT/SEC"> 100 </damping_coeff>
			<max_steer unit="DEG"> 10.00 </max_steer>
			<brake_group>NONE</brake_group>
			<retractable>0</retractable>
		</contact>

		<contact type="BOGEY" name="LEFT_MAIN">
			<location unit="FT">
			 <x> 8.04</x>	<!--x>2.13</x-->
			 <y>-2.62</y>
			 <z>-3.29</z>
			</location>
			<static_friction>  0.80 </static_friction>
			<dynamic_friction> 0.50 </dynamic_friction>
			<rolling_friction> 0.02 </rolling_friction>
			<spring_coeff unit="LBS/FT">       2000 </spring_coeff>
			<damping_coeff unit="LBS/FT/SEC">   50 </damping_coeff>
			<max_steer unit="DEG">0</max_steer>
			<brake_group>LEFT</brake_group>
			<retractable>0</retractable>
		</contact>

		<contact type="BOGEY" name="RIGHT_MAIN">
			<location unit="FT">
			 <x> 8.04</x>	<!--x>2.13</x-->
			 <y>2.62</y>
			 <z>-3.29</z>
			</location>
			<static_friction>  0.80 </static_friction>
			<dynamic_friction> 0.50 </dynamic_friction>
			<rolling_friction> 0.02 </rolling_friction>
			<spring_coeff unit="LBS/FT">       2000 </spring_coeff>
			<damping_coeff unit="LBS/FT/SEC">   50 </damping_coeff>
			<max_steer unit="DEG">0</max_steer>
			<brake_group>RIGHT</brake_group>
			<retractable>0</retractable>
		</contact>

		<contact type="STRUCTURE" name="LEFT_WING_TIP">
			<location unit="M">
			 <x>2.41</x>
			 <y>-4.389</y>
			</location>
			<static_friction>  1.00 </static_friction>
			<dynamic_friction> 1.00 </dynamic_friction>
			<spring_coeff unit="LBS/FT">        1041.86 </spring_coeff>
			<damping_coeff unit="LBS/FT/SEC">   1041.86 </damping_coeff>
		</contact>

		<contact type="STRUCTURE" name="RIGHT_WING_TIP">
			<location unit="M">
			 <x>2.41</x>
			 <y>4.389</y>
			</location>
			<static_friction>  1.00 </static_friction>
			<dynamic_friction> 1.00 </dynamic_friction>
			<spring_coeff unit="LBS/FT">       1041.86 </spring_coeff>
			<damping_coeff unit="LBS/FT/SEC">  1041.86 </damping_coeff>
		</contact>

		<contact type="STRUCTURE" name="TAIL_SKID">
			<location unit="M">
			 <x>5.88</x>
			 <z>-0.347</z>
			</location>
			<static_friction> 0.5 </static_friction>
			<dynamic_friction> 0.25 </dynamic_friction>
			<spring_coeff unit="LBS/FT">       2000 </spring_coeff>
			<damping_coeff unit="LBS/FT/SEC">  1000 </damping_coeff>
			</contact>		
	</ground_reactions>

 <system file="Landing Gear.xml"/>
	
 <propulsion>

   <engine file="ROTAX912ULS">
    <location unit="FT">
      <x>2.15</x>	<!--x>-3.76</x-->
    </location>
    <feed> 0 </feed>
    <feed> 1 </feed>
	
    <thruster file="DUCHELICES-SWIRL3">
     <sense> 1 </sense>
     <location unit="FT">
       <x>0</x>	<!--x>-5.91</x-->
     </location>
     <orient unit="DEG">
       <pitch>     0.00 </pitch>
        <roll>     0.00 </roll>
         <yaw>     0.00 </yaw>
     </orient>
    </thruster>
  </engine>

  <tank type="FUEL" number="0">
     <location unit="IN">
       <x>  90.551 </x>
       <y> -22.677 </y>
       <z> -12.000 </z>
     </location>
     <capacity unit="LBS">  87.47 </capacity>  <!-- 55l of fuel -->
     <contents unit="LBS">  36.71 </contents>
	 <type>AVGAS</type>
  </tank>

  <tank type="FUEL" number="1">
     <location unit="IN">
       <x>  90.551 </x>
       <y>  22.677 </y>
       <z> -12.000 </z>
     </location>
     <capacity unit="LBS">  87.47 </capacity> <!-- 55l of fuel -->
     <contents unit="LBS">  36.71 </contents>
	 <type>AVGAS</type>
  </tank>

 		<!--    THRUST COEFFICIENT
			Datcom uses a different formula than JSBSim does to calculate thrust coefficent. 
			Datcom uses:
				Tc = Total Thrust / ( q * s)
			contained in property: propulsion/total-thrust-coefficient

			whereas JSBSim calculates per-engine thrust coefficient
				Tc = Thrust / ( RPS^2 * D^4 * rho )
			contained in property: propulsion/engine[x]/thrust-coefficient
		-->
		<function name="propulsion/total-thrust-coefficient">
			<description> Total thrust coefficient calculation </description>
			<quotient>
				<property>propulsion/engine/thrust-lbs</property>
				<property>aero/qbar-area</property>
			</quotient>
		</function>
		
 </propulsion>
 
 
<!-- **********************************************************************
        AUTOPILOT
     *******************************************************************-->
   <!-- This is provided so that you can write an autopilot 
        model for your aircraft, based on a generic autopilot      -->

    <autopilot file="Systems/autopilot.xml"/>
	
<!-- **********************************************************************
        FLIGHT CONTROLS
     *******************************************************************-->
	<flight_control name="FCS: ProMecc-Freccia">

		<channel name="Pitch">
			<summer name="fcs/pitch-control-sum">
				<input> fcs/elevator-cmd-norm </input>
				<input> fcs/pitch-trim-cmd-norm </input>
				<input> ap/longitudinal-cmd </input>
				<clipto>
					<min> -1.0 </min>
					<max>  1.0 </max>
				</clipto>
			</summer>

			<aerosurface_scale name="Elevator-Position-in-deg">
				<input> fcs/pitch-control-sum </input>
				<zero_centered> true </zero_centered>
				<domain>
					<min> -1.0 </min>
					<max>  1.0 </max>
				</domain>
				<range>
					<min>-20.00</min>
					<max> 15.00</max>
				</range>
				<output> fcs/elevator-pos-deg </output>
			</aerosurface_scale>
		</channel>


		<channel name="Roll">
			<summer name="fcs/roll-control-sum">
				<input> fcs/aileron-cmd-norm </input>
				<input> fcs/roll-trim-cmd-norm </input>
				<input> ap/lateral-cmd </input>
				<clipto>
					<min> -1.0 </min>
					<max>  1.0 </max>
				</clipto>
			</summer>
			<aerosurface_scale name="Left-aileron-Position-in-deg">
				<input> fcs/roll-control-sum </input>
				<zero_centered> true </zero_centered>
				<domain>
					<min> -1.0 </min>
					<max>  1.0 </max>
				</domain>
				<range>
					<min> -12.00</min>
					<max>  24.00</max>
				</range>
				<output> fcs/left-aileron-pos-deg </output>
			</aerosurface_scale>

			<aerosurface_scale name="Right-aileron-Position-in-deg">
				<input> -fcs/roll-control-sum </input>
				<zero_centered> true </zero_centered>
				<domain>
					<min> -1.0 </min>
					<max>  1.0 </max>
				</domain>
				<range>
					<min>-12.00</min>
					<max> 24.00</max>
				</range>
				<output> fcs/right-aileron-pos-deg </output>
			</aerosurface_scale>

			<summer name="fcs/total-aileron-pos-deg">
				<description> Total control deflection (Left-Right)</description>
				<input>  fcs/left-aileron-pos-deg </input>
				<input> -fcs/right-aileron-pos-deg </input>
			</summer>

		</channel>


		<channel name="Yaw">

			<!-- Datcom doesn't calculate rudder parameters, but this is included for completeness -->
			<summer name="fcs/yaw-control-sum">
				<input> fcs/rudder-cmd-norm </input>
				<input> fcs/yaw-trim-cmd-norm </input>
				<input> ap/directional-cmd </input>
				<clipto>
				<min> -1.0 </min>
				<max>  1.0 </max>
				</clipto>
			</summer>

			<aerosurface_scale name="fcs/rudder">
				<input> fcs/yaw-control-sum </input>
				<zero_centered> true </zero_centered>
				<domain>
				<min> -1.0 </min>
				<max>  1.0 </max>
				</domain>
				<range>
				<min> -25.0 </min>
				<max>  25.0 </max>
				</range>
				<output> fcs/rudder-pos-deg </output>
			</aerosurface_scale>

		</channel>


		<channel name="Flaps">
			<kinematic name="flap-control">
				<input> fcs/flap-cmd-norm </input>
				<traverse>
					<setting>
						<position>  .000 </position>			<!--    .00 deg -->
						<time>       .00 </time>
					</setting>
					<setting>
						<position>  .143 </position>			<!--   5.00 deg -->
						<time>      1.00 </time>
					</setting>
					<setting>
						<position>  .286 </position>			<!--  10.00 deg -->
						<time>      2.00 </time>
					</setting>
					<setting>
						<position>  .429 </position>			<!--  15.00 deg -->
						<time>      3.00 </time>
					</setting>
					<setting>
						<position>  .571 </position>			<!--  20.00 deg -->
						<time>      4.00 </time>
					</setting>
					<setting>
						<position>  .714 </position>			<!--  25.00 deg -->
						<time>      5.00 </time>
					</setting>
					<setting>
						<position>  .857 </position>			<!--  30.00 deg -->
						<time>     6.00 </time>
					</setting>
					<setting>
						<position> 1.000 </position>			<!--  35.00 deg -->
						<time>    7.00 </time>
					</setting>
				</traverse>
				<output> fcs/flap-pos-norm </output>
			</kinematic>

			<aerosurface_scale name="fcs/flap-position">
				<input> fcs/flap-pos-norm </input>
					<zero_centered> false </zero_centered>
					<domain>
						<min>  0.0 </min>
						<max>  1.0 </max>
					</domain>
					<range>
						<min>   .00 </min>
						<max> 35.00 </max>
					</range>
					<output> fcs/flap-pos-deg </output>
			</aerosurface_scale>

		</channel>


		<channel name="Landing Gear">
			<kinematic name="gear-control">
				<input>gear/gear-cmd-norm</input>
				<traverse>
					<setting>
						<position> 0 </position>
						<time>     0 </time>
					</setting>
					<setting>
						<position> 1 </position>
						<time>     5 </time>
					</setting>
				</traverse>
				<output>gear/gear-pos-norm</output>
			</kinematic>
		</channel>

        <channel name="Braking">      
            <summer name="fcs/parking-brake-sum">
                <!--input>/sim/model/ProMeccFreccia/securing/chock-visible</input-->
                <!--input>/fdm/jsbsim/damage/repairing</input-->
                <input>/controls/gear/brake-parking</input>
            </summer>
            
            <fcs_function name="fcs/left-brake-sum">
                <function>
                    <max>
                        <property>fcs/parking-brake-sum</property>
                        <property>/controls/gear/brake-left</property>
						<property>/controls/gear/brake-right</property>
                    </max>
                </function>
                <output>fcs/left-brake-cmd-norm</output>
            </fcs_function>
            
            <fcs_function name="fcs/right-brake-sum">
                <function>
                    <max>
                        <property>fcs/parking-brake-sum</property>
                        <property>/controls/gear/brake-right</property>
						<property>/controls/gear/brake-left</property>
                    </max>
                </function>
                <output>fcs/right-brake-cmd-norm</output>
            </fcs_function>
        </channel>
		
	</flight_control>


<!-- **********************************************************************
                                    AERODYNAMICS
     *******************************************************************-->
	<!-- Link to the aerodynamics file -->
	<aerodynamics file="ProMecc-Freccia_aero.xml"/>

 <external_reactions>
 </external_reactions>

</fdm_config>
